;/*FB_PKG_DELIM*/

__d("LSComputeParticipantCapabilities",["LSGetViewerFBID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[];return c.seq([function(f){return c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[0]=a[0],a})},function(b){return c.ftr(c.db.table(14).fetch([[[a[1],d[0]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(b.contactId,d[0])}).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[!1,!1],d[1]=c[0],d[2]=c[1],c):(b=a.item,c=[b.isAdmin==null?!1:b.isAdmin,b.isModerator],d[1]=c[0],d[2]=c[1],c)})},function(b){return c.ftr(c.db.table(14).fetch([[[a[1],a[0]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(b.contactId,a[0])}).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[!1,!1],d[4]=c[0],d[5]=c[1],c):(b=a.item,c=[b.isAdmin==null?!1:b.isAdmin,b.isModerator],d[4]=c[0],d[5]=c[1],c)})},function(b){return c.ftr(c.db.table(7).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.id,a[0])&&c.i64.eq([0,1],[0,1])}).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[[0,1073741823],[0,0],!1],d[7]=c[0],d[8]=c[1],d[9]=c[2],c):(b=a.item,c=[b.capabilities==null?[0,1073741823]:b.capabilities,b.contactTypeExact==null?[0,0]:b.contactTypeExact,b.isManagedByViewer==null?!1:b.isManagedByViewer],d[7]=c[0],d[8]=c[1],d[9]=c[2],c)})},function(a){return d[12]=c.i64.eq(d[8],[0,4])?d[9]?[0,2612119]:c.i64.or_([0,2612119],c.i64.lsl_([0,1],c.i64.to_int32([0,3]))):d[7],c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[11]=a[0],a})},function(e){return d[13]=c.i64.lsl_([0,1],c.i64.to_int32([0,20])),d[15]=d[1]&&!d[4]&&c.i64.neq(d[11],a[0])?d[12]:c.i64.eq(c.i64.and_(d[12],d[13]),[0,0])?d[12]:c.i64.sub(d[12],d[13]),c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[14]=a[0],a})},function(e){return d[16]=c.i64.lsl_([0,1],c.i64.to_int32([0,22])),d[19]=d[4]&&d[1]&&c.i64.neq(d[14],a[0])?d[15]:c.i64.eq(c.i64.and_(d[15],d[16]),[0,0])?d[15]:c.i64.sub(d[15],d[16]),d[2]?d[17]=!(d[4]||d[5]):d[17]=!0,c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[18]=a[0],a})},function(b){return d[20]=c.i64.lsl_([0,1],c.i64.to_int32([0,21])),e[0]=(d[1]||d[2])&&d[17]&&c.i64.neq(a[0],d[18])?d[19]:c.i64.eq(c.i64.and_(d[19],d[20]),[0,0])?d[19]:c.i64.sub(d[19],d[20])}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSAddParticipantIdToGroupThread",["LSComputeParticipantCapabilities"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[];return c.seq([function(e){return c.seq([function(e){return c.sp(b("LSComputeParticipantCapabilities"),a[1],a[0]).then(function(a){return a=a,d[0]=a[0],a})},function(b){return c.ftr(c.db.table(14).fetch([[[a[0],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq([0,0],[0,0])&&c.i64.eq(b.contactId,a[1])&&c.i64.gt(b.authorityLevel,a[9])}).next().then(function(b){var e=b.done;b.value;return e?c.db.table(14).put({threadKey:a[0],contactId:a[1],readWatermarkTimestampMs:a[2],readActionTimestampMs:a[3],deliveredWatermarkTimestampMs:a[4],nickname:a[5],normalizedSearchTerms:a[10],isAdmin:a[6],isSuperAdmin:a[11],subscribeSource:a[7],authorityLevel:a[9],participantCapabilities:d[0],groupParticipantJoinState:[0,0],isModerator:!1}):0})}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSClearLoadingFlagsForThreadRange",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(d){return a[1]?b.fe(b.db.table(10).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({isLoadingAfter:!1})}):b.seq([function(d){return b.i64.eq([0,0],a[0])?b.seq([function(c){return b.fe(b.db.table(198).fetch([[[a[2]]]]),function(a){var b=a.update;a.item;return b({isLoadingBefore:!1})})},function(a){return c[8]=[0,0],c[9]=e,c[10]=!1,c[11]=!1,b.fe(b.db.table(198).fetch(),function(a){a=a.item;return c[12]=a.minLastActivityTimestampMs,c[14]=a.minThreadKey,c[13]=b.i64.lt(c[8]==null?c[12]:c[8],c[12]),c[8]=c[13]?c[12]:c[8],c[9]=c[13]?c[14]:c[9],c[10]=c[10]||a.isLoadingBefore,c[11]=c[11]||b.i64.gt(c[12],[0,1])&&b.i64.gt(c[14],[-2147483648,0])})},function(a){return a=[c[8],c[9],c[10],c[11]],c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],a}]):b.resolve((d=[[0,0],e,!1,!1],c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],d))},function(c){return b.fe(b.db.table(220).fetch([[[a[2],a[0]]]]),function(a){var b=a.update;a.item;return b({isLoadingBefore:!1})})},function(d){return c[4]=c[0],c[5]=c[1],c[6]=c[2],c[7]=c[3],b.fe(b.ftr(b.db.table(220).fetch(),function(c){return b.i64.eq(c.parentThreadKey,a[0])}),function(a){a=a.item;return c[8]=a.minLastActivityTimestampMs,c[10]=a.minThreadKey,c[9]=b.i64.lt(c[4]==null?c[8]:c[4],c[8]),c[4]=c[9]?c[8]:c[4],c[5]=c[9]?c[10]:c[5],c[6]=c[6]||a.isLoadingBefore,c[7]=c[7]||b.i64.gt(c[8],[0,1])&&b.i64.gt(c[10],[-2147483648,0])})},function(d){return b.fe(b.db.table(10).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({isLoadingBefore:c[6]})})}])},function(a){return b.resolve(d)}])}b=a;f["default"]=b}),66);
__d("LSClearMessagePlaceholderRange",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.ftr(b.db.table(13).fetch([[[a[0],[0,0]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&c.minMessageId===a[1]&&b.i64.eq([0,0],c.minTimestampMs)&&b.i64.eq(a[2],c.maxTimestampMs)}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSClearPinnedMessages",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.db.table(205).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSDeleteExistingMessageRanges",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.db.table(13).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSFetchJoinedCommunityThreads",["LSArrayGetObjectAt","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return a[1]===!0?c.seq([function(a){return d[1]=c.createArray(),c.fe(c.db.table(9).fetch([[[[0,23]],[[0,21]],[[0,18]]],"threadTypeLastActivityTimestampMs"]),function(a){a=a.item;return d[3]=(d[1].push(a.threadKey),d[1])})},function(e){return d[2]=c.i64.of_int32(d[1].length),c.i64.neq(d[2],[0,0])?c.seq([function(a){return c.ntop("Array",b("LSArrayGetObjectAt"),d[1],[0,0]).then(function(a){return a=a,d[3]=a[0],d[4]=a[1],a})},function(e){return d[5]=new c.Map(),d[5].set("thread_fbid",d[3]),d[5].set("thread_fbids",d[1]),d[5].set("force_upsert",!1),d[5].set("use_open_messenger_transport",!1),d[5].set("sync_group",[0,1]),d[5].set("metadata_only",a[0]),d[5].set("preview_only",!1),d[6]=d[5].get("thread_fbid"),d[5],d[7]=c.toJSON(d[5]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[6]),[0,209],d[7],f,f,[0,0],[0,0],f,f,[0,0])}]):c.resolve()}]):c.fe(c.db.table(9).fetch([[[[0,23]],[[0,21]],[[0,18]]],"threadTypeLastActivityTimestampMs"]),function(e){e=e.item;return d[1]=new c.Map(),d[1].set("thread_fbid",e.threadKey),d[1].set("force_upsert",!1),d[1].set("use_open_messenger_transport",!1),d[1].set("sync_group",[0,1]),d[1].set("metadata_only",a[0]),d[1].set("preview_only",!1),d[2]=d[1].get("thread_fbid"),d[1],d[3]=c.toJSON(d[1]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[2]),[0,209],d[3],f,f,[0,0],[0,0],f,f,[0,0])})},function(a){return c.ct(c.db.table(9).fetch([[[[0,23]],[[0,21]],[[0,18]]],"threadTypeLastActivityTimestampMs"])).then(function(a){return d[0]=a})},function(a){return c.i64.gt(d[0],[0,0])?(d[1]=new c.Map(),d[1].set("number_of_threads",d[0]),d[1].set("event_type","issue_tpq_on_mailbox_resnapshot"),d[2]=c.toJSON(d[1]),c.sp(b("LSIssueNewTask"),"log_community_resnapshot_event",[0,576],d[2],f,f,[0,0],[0,0],f,f,[0,0])):c.resolve()}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSInsertNewMessageRange",["LSClearMessagePlaceholderRange"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[];return c.seq([function(e){return c.seq([function(d){return c.sp(b("LSClearMessagePlaceholderRange"),a[0],a[9],[0,0])},function(b){return c.ftr(c.db.table(13).fetch([[[a[0],{lte:a[5]}]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.le(b.minTimestampMs,a[5])&&c.i64.ge(b.maxTimestampMs,a[5])}).next().then(function(b,c){var e=b.done;b=b.value;return e?(e=[a[1],a[3],a[7]],d[0]=e[0],d[1]=e[1],d[2]=e[2],e):(c=b.item,e=[c.minTimestampMs,c.minMessageId,c.hasMoreBefore],d[0]=e[0],d[1]=e[1],d[2]=e[2],e)})},function(b){return c.ftr(c.db.table(13).fetch([[[a[0],{lte:a[6]}]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.le(b.minTimestampMs,a[6])&&c.i64.ge(b.maxTimestampMs,a[6])}).next().then(function(b,c){var e=b.done;b=b.value;return e?(e=[a[2],a[4],a[8]],d[4]=e[0],d[5]=e[1],d[6]=e[2],e):(c=b.item,e=[c.maxTimestampMs,c.maxMessageId,c.hasMoreAfter],d[4]=e[0],d[5]=e[1],d[6]=e[2],e)})},function(b){return c.fe(c.ftr(c.db.table(13).fetch([[[a[0],{lte:a[6]}]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.ge(a[6],b.minTimestampMs)&&c.i64.le(a[5],b.maxTimestampMs)}),function(a){return a["delete"]()})},function(b){return c.db.table(13).put({threadKey:a[0],minTimestampMs:d[0],minMessageId:d[1],maxTimestampMs:d[4],maxMessageId:d[5],isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:d[2],hasMoreAfter:d[6]})}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSSetForwardScore",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.ftr(b.db.table(12).fetch([[[a[0],a[2],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq([0,0],[0,0])&&b.i64.eq(c.timestampMs,a[2])&&c.messageId===a[1]}),function(b){var c=b.update;b.item;return c({forwardScore:a[3]})})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSSetHMPSStatus",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.resolve(c)}b=a;f["default"]=b}),66);
__d("LSUpsertInboxThreadsRange",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.db.table(198).put({syncGroup:a[0],minLastActivityTimestampMs:a[1],hasMoreBefore:a[2],isLoadingBefore:a[3],minThreadKey:a[4]})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSUpsertSyncGroupThreadsRange",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.db.table(220).put({syncGroup:a[0],parentThreadKey:a[1],minLastActivityTimestampMs:a[2],hasMoreBefore:a[3],isLoadingBefore:a[4],minThreadKey:a[5]})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSThreadsRangesQuery",["LSClearLoadingFlagsForThreadRange","LSGetCursor","LSIssueNewTaskAndGetTaskID","LSUpsertInboxThreadsRange","LSUpsertSyncGroupThreadsRange"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return a[1]&&c.i64.eq(a[6],[0,0])?c.sp(b("LSClearLoadingFlagsForThreadRange"),a[0],!1,[0,1]):(a[1]&&c.i64.neq(a[6],f)&&c.i64.neq(a[3],f)||a[2]&&c.i64.neq(a[5],f)&&c.i64.neq(a[4],f))&&!(a[1]&&c.i64.neq(a[6],f)&&c.i64.neq(a[3],f)&&a[2]&&c.i64.neq(a[5],f)&&c.i64.neq(a[4],f))?c.seq([function(e){return d[16]=a[3]==null?[-2147483648,0]:a[3],d[15]=a[6]==null?[0,1]:a[6],d[17]=c.i64.gt(d[15],[0,1])&&c.i64.gt(d[16],[-2147483648,0]),d[4]=c.i64.eq([0,1],[0,1])||c.i64.eq([0,1],[0,95]),d[4]&&c.i64.eq(a[0],[0,0])?c.seq([function(a){return c.sp(b("LSUpsertInboxThreadsRange"),[0,1],d[15],d[17],!0,d[16])},function(a){return d[18]=d[15],d[19]=d[16],d[20]=!0,d[21]=d[17],c.fe(c.db.table(198).fetch(),function(a){a=a.item;return d[22]=a.minLastActivityTimestampMs,d[24]=a.minThreadKey,d[23]=c.i64.lt(d[18]==null?d[22]:d[18],d[22]),d[18]=d[23]?d[22]:d[18],d[19]=d[23]?d[24]:d[19],d[20]=d[20]||a.isLoadingBefore,d[21]=d[21]||c.i64.gt(d[22],[0,1])&&c.i64.gt(d[24],[-2147483648,0])})},function(a){return a=[d[18],d[19],d[20],d[21]],d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],a}]):c.resolve((e=[d[15],d[16],!0,d[17]],d[0]=e[0],d[1]=e[1],d[2]=e[2],d[3]=e[3],e))},function(e){return d[4]?c.seq([function(e){return c.sp(b("LSUpsertSyncGroupThreadsRange"),[0,1],a[0],d[15],d[17],!0,d[16])},function(b){return d[18]=d[15],d[19]=d[16],d[20]=!0,d[21]=d[17],c.fe(c.ftr(c.db.table(220).fetch(),function(b){return c.i64.eq(b.parentThreadKey,a[0])}),function(a){a=a.item;return d[22]=a.minLastActivityTimestampMs,d[24]=a.minThreadKey,d[23]=c.i64.lt(d[18]==null?d[22]:d[18],d[22]),d[18]=d[23]?d[22]:d[18],d[19]=d[23]?d[24]:d[19],d[20]=d[20]||a.isLoadingBefore,d[21]=d[21]||c.i64.gt(d[22],[0,1])&&c.i64.gt(d[24],[-2147483648,0])})},function(a){return a=[d[18],d[19],d[20],d[21]],d[5]=a[0],d[6]=a[1],d[7]=a[2],d[8]=a[3],a}]):c.resolve((e=[d[0],d[1],d[2],d[3]],d[5]=e[0],d[6]=e[1],d[7]=e[2],d[8]=e[3],e))},function(a){return c.sp(b("LSGetCursor"),[0,1]).then(function(a){return a=a,d[9]=a[0],a})},function(e){return d[10]=new c.Map(),d[10].set("is_after",a[2]),d[10].set("parent_thread_key",a[0]),d[10].set("reference_thread_key",a[2]?a[4]:a[3]),d[10].set("reference_activity_timestamp",a[2]?a[5]:a[6]),d[10].set("additional_pages_to_fetch",a[7]),d[10].set("cursor",d[9]),d[10].set("messaging_tag",f),d[10].set("sync_group",[0,1]),c.i64.gt([0,0],[0,0])?(d[18]=c.i64.of_float(Date.now()),d[11]=c.i64.add(d[18],[0,0])):d[11]=[0,0],d[12]=c.toJSON(d[10]),c.sp(b("LSIssueNewTaskAndGetTaskID"),"trq",[0,145],d[12],f,f,[0,0],[0,0],f,f,d[11]).then(function(a){return a=a,d[13]=a[0],a})},function(b){return c.db.table(10).fetch([[[a[0]]]]).next().then(function(b,e){e=b.done;b=b.value;return e?c.db.table(10).add({parentThreadKey:a[0],minThreadKey:d[6]==null?[-2147483648,0]:d[6],minLastActivityTimestampMs:d[5]==null?[0,1]:d[5],maxLastActivityTimestampMs:[0,1],maxThreadKey:[-2147483648,0],isLoadingBefore:d[8],isLoadingAfter:!1,hasMoreBefore:d[8],hasMoreAfter:!1}):(b.item,c.fe(c.db.table(10).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({isLoadingBefore:d[7],isLoadingAfter:!1,hasMoreBefore:d[8],hasMoreAfter:!1})}))})}]):c.resolve()},function(e){return a[8]?c.resolve():a[1]&&c.i64.eq(a[6],[0,0])?c.sp(b("LSClearLoadingFlagsForThreadRange"),a[0],!1,[0,95]):(a[1]&&c.i64.neq(a[6],f)&&c.i64.neq(a[3],f)||a[2]&&c.i64.neq(a[5],f)&&c.i64.neq(a[4],f))&&!(a[1]&&c.i64.neq(a[6],f)&&c.i64.neq(a[3],f)&&a[2]&&c.i64.neq(a[5],f)&&c.i64.neq(a[4],f))?c.seq([function(e){return d[16]=a[3]==null?[-2147483648,0]:a[3],d[15]=a[6]==null?[0,1]:a[6],d[17]=c.i64.gt(d[15],[0,1])&&c.i64.gt(d[16],[-2147483648,0]),d[4]=c.i64.eq([0,95],[0,1])||c.i64.eq([0,95],[0,95]),d[4]&&c.i64.eq(a[0],[0,0])?c.seq([function(a){return c.sp(b("LSUpsertInboxThreadsRange"),[0,95],d[15],d[17],!0,d[16])},function(a){return d[18]=d[15],d[19]=d[16],d[20]=!0,d[21]=d[17],c.fe(c.db.table(198).fetch(),function(a){a=a.item;return d[22]=a.minLastActivityTimestampMs,d[24]=a.minThreadKey,d[23]=c.i64.lt(d[18]==null?d[22]:d[18],d[22]),d[18]=d[23]?d[22]:d[18],d[19]=d[23]?d[24]:d[19],d[20]=d[20]||a.isLoadingBefore,d[21]=d[21]||c.i64.gt(d[22],[0,1])&&c.i64.gt(d[24],[-2147483648,0])})},function(a){return a=[d[18],d[19],d[20],d[21]],d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],a}]):c.resolve((e=[d[15],d[16],!0,d[17]],d[0]=e[0],d[1]=e[1],d[2]=e[2],d[3]=e[3],e))},function(e){return d[4]?c.seq([function(e){return c.sp(b("LSUpsertSyncGroupThreadsRange"),[0,95],a[0],d[15],d[17],!0,d[16])},function(b){return d[18]=d[15],d[19]=d[16],d[20]=!0,d[21]=d[17],c.fe(c.ftr(c.db.table(220).fetch(),function(b){return c.i64.eq(b.parentThreadKey,a[0])}),function(a){a=a.item;return d[22]=a.minLastActivityTimestampMs,d[24]=a.minThreadKey,d[23]=c.i64.lt(d[18]==null?d[22]:d[18],d[22]),d[18]=d[23]?d[22]:d[18],d[19]=d[23]?d[24]:d[19],d[20]=d[20]||a.isLoadingBefore,d[21]=d[21]||c.i64.gt(d[22],[0,1])&&c.i64.gt(d[24],[-2147483648,0])})},function(a){return a=[d[18],d[19],d[20],d[21]],d[5]=a[0],d[6]=a[1],d[7]=a[2],d[8]=a[3],a}]):c.resolve((e=[d[0],d[1],d[2],d[3]],d[5]=e[0],d[6]=e[1],d[7]=e[2],d[8]=e[3],e))},function(a){return c.sp(b("LSGetCursor"),[0,95]).then(function(a){return a=a,d[9]=a[0],a})},function(e){return d[10]=new c.Map(),d[10].set("is_after",a[2]),d[10].set("parent_thread_key",a[0]),d[10].set("reference_thread_key",a[2]?a[4]:a[3]),d[10].set("reference_activity_timestamp",a[2]?a[5]:a[6]),d[10].set("additional_pages_to_fetch",a[7]),d[10].set("cursor",d[9]),d[10].set("messaging_tag",f),d[10].set("sync_group",[0,95]),c.i64.gt([0,0],[0,0])?(d[18]=c.i64.of_float(Date.now()),d[11]=c.i64.add(d[18],[0,0])):d[11]=[0,0],d[12]=c.toJSON(d[10]),c.sp(b("LSIssueNewTaskAndGetTaskID"),"trq",[0,145],d[12],f,f,[0,0],[0,0],f,f,d[11]).then(function(a){return a=a,d[13]=a[0],a})},function(b){return c.db.table(10).fetch([[[a[0]]]]).next().then(function(b,e){e=b.done;b=b.value;return e?c.db.table(10).add({parentThreadKey:a[0],minThreadKey:d[6]==null?[-2147483648,0]:d[6],minLastActivityTimestampMs:d[5]==null?[0,1]:d[5],maxLastActivityTimestampMs:[0,1],maxThreadKey:[-2147483648,0],isLoadingBefore:d[8],isLoadingAfter:!1,hasMoreBefore:d[8],hasMoreAfter:!1}):(b.item,c.fe(c.db.table(10).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({isLoadingBefore:d[7],isLoadingAfter:!1,hasMoreBefore:d[8],hasMoreAfter:!1})}))})}]):c.resolve()}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSTruncateThreadRangeTablesForSyncGroup",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.seq([function(c){return b.i64.eq(a[0],[0,1])?b.fe(b.ftr(b.db.table(10).fetch(),function(a){return b.i64.eq([0,1]==null?[0,1]:[0,1],[0,1])}),function(a){return a["delete"]()}):b.fe(b.ftr(b.db.table(10).fetch([[[[0,0]],[[-1,4294967295]]]]),function(a){return b.i64.eq([0,1]==null?[0,1]:[0,1],[0,1])&&(b.i64.eq(a.parentThreadKey,[0,0])||b.i64.eq(a.parentThreadKey,[-1,4294967295]))}),function(a){return a["delete"]()})},function(c){return b.i64.eq(a[0],[0,1])?b.fe(b.ftr(b.db.table(247).fetch(),function(a){return b.i64.eq([0,1]==null?[0,1]:[0,1],[0,1])}),function(a){return a["delete"]()}):b.resolve()},function(c){return b.fe(b.db.table(198).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(c){return b.fe(b.db.table(220).fetch([[[a[0]]]]),function(a){return a["delete"]()})}])},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSTruncateTablesForSyncGroup",["LSTruncateThreadRangeTablesForSyncGroup"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[];return c.seq([function(d){return c.seq([function(b){return c.fe(c.ftr(c.db.table(9).fetch(),function(b){return c.i64.eq(b.syncGroup==null?[0,1]:b.syncGroup,a[0])&&![[0,17],[0,18],[0,19],[0,20],[0,21],[0,22],[0,23],[0,24],[0,25]].some(function(a){return c.i64.eq(b.threadType,a)})}),function(a){return a["delete"]()})},function(d){return c.sp(b("LSTruncateThreadRangeTablesForSyncGroup"),a[0])}])},function(a){return c.resolve(d)}])}c=a;f["default"]=c}),66);
__d("LSUpdateReadReceipt",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.ftr(b.db.table(14).fetch([[[a[1],a[2]]]]),function(c){return b.i64.eq(c.threadKey,a[1])&&b.i64.eq([0,0],[0,0])&&b.i64.eq(c.contactId,a[2])&&b.i64.lt(c.readWatermarkTimestampMs,a[0])}),function(c){var d=c.update;c=c.item;return d({readWatermarkTimestampMs:a[0],readActionTimestampMs:b.i64.gt(a[3],[0,0])?a[3]:c.readActionTimestampMs})})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSUpdateThreadsRangesV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[];return b.seq([function(d){return b.seq([function(c){return b.fe(b.db.table(10).fetch([[[a[1]]]]),function(a){return a["delete"]()})},function(d){return c[8]=b.i64.gt(a[2],[0,1])&&b.i64.gt(a[3],[-2147483648,0]),a[0]==="inbox"&&b.i64.eq(a[1],[0,0])&&b.i64.eq(a[4],[0,1])?b.seq([function(d){return c[9]=a[2],c[10]=a[3],c[11]=!1,c[12]=c[8],b.fe(b.db.table(198).fetch(),function(a){a=a.item;return c[13]=a.minLastActivityTimestampMs,c[15]=a.minThreadKey,c[14]=b.i64.lt(c[9]==null?c[13]:c[9],c[13]),c[9]=c[14]?c[13]:c[9],c[10]=c[14]?c[15]:c[10],c[11]=c[11]||a.isLoadingBefore,c[12]=c[12]||b.i64.gt(c[13],[0,1])&&b.i64.gt(c[15],[-2147483648,0])})},function(a){return a=[c[9],c[10],c[11],c[12]],c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],a}]):b.resolve((d=[a[2],a[3],!1,c[8]],c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],d))},function(d){return b.i64.eq(a[4],[0,1])?b.seq([function(d){return c[9]=c[0],c[10]=c[1],c[11]=c[2],c[12]=c[3],b.fe(b.ftr(b.db.table(220).fetch(),function(c){return b.i64.eq(c.parentThreadKey,a[1])}),function(a){a=a.item;return c[13]=a.minLastActivityTimestampMs,c[15]=a.minThreadKey,c[14]=b.i64.lt(c[9]==null?c[13]:c[9],c[13]),c[9]=c[14]?c[13]:c[9],c[10]=c[14]?c[15]:c[10],c[11]=c[11]||a.isLoadingBefore,c[12]=c[12]||b.i64.gt(c[13],[0,1])&&b.i64.gt(c[15],[-2147483648,0])})},function(a){return a=[c[9],c[10],c[11],c[12]],c[4]=a[0],c[5]=a[1],c[6]=a[2],c[7]=a[3],a}]):b.resolve((d=[c[0],c[1],c[2],c[3]],c[4]=d[0],c[5]=d[1],c[6]=d[2],c[7]=d[3],d))},function(d){return b.db.table(10).add({parentThreadKey:a[1],minThreadKey:c[5]==null?[-2147483648,0]:c[5],minLastActivityTimestampMs:c[4]==null?[0,1]:c[4],maxLastActivityTimestampMs:[0,1],maxThreadKey:[-2147483648,0],isLoadingBefore:c[6],isLoadingAfter:!1,hasMoreBefore:c[7],hasMoreAfter:!1})}])},function(a){return b.resolve(d)}])}b=a;f["default"]=b}),66);
__d("LSUpsertFolderSeenTimestamp",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.i64.gt(a[1],[0,0])?b.db.table(35).fetch([[[a[0]]]]).next().then(function(c,d){var e=c.done;c=c.value;return e?b.db.table(35).add({parentThreadKey:a[0],lastSeenRequestTimestampMs:a[1]}):(d=c.item,b.i64.lt(d.lastSeenRequestTimestampMs,a[1])?b.fe(b.db.table(35).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({lastSeenRequestTimestampMs:a[1]})}):b.resolve())}):b.resolve()},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSUpsertMessage",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.db.table(12).fetch([[[a[9]]],"optimistic"]).next().then(function(c,d){var e=c.done;c=c.value;return e?b.db.table(12).add({threadKey:a[3],timestampMs:a[5],messageId:a[8],offlineThreadingId:a[9],authorityLevel:a[2],primarySortKey:a[6],senderId:a[10],isAdminMessage:a[12],sendStatus:a[14],sendStatusV2:a[15],text:a[0],subscriptErrorMessage:a[1],secondarySortKey:a[7],stickerId:a[11],isUnsent:a[16],unsentTimestampMs:a[17],mentionOffsets:a[18],mentionLengths:a[19],mentionIds:a[20],mentionTypes:a[21],replySourceId:a[22],replySourceType:a[23],replySourceTypeV2:a[24],replyStatus:a[25],replySnippet:a[26],replyMessageText:a[27],replyToUserId:a[28],replyMediaExpirationTimestampMs:a[29],replyMediaUrl:a[30],replyMediaPreviewWidth:a[32],replyMediaPreviewHeight:a[33],replyMediaUrlMimeType:a[34],replyMediaUrlFallback:a[35],replyCtaId:a[36],replyCtaTitle:a[37],replyAttachmentType:a[38],replyAttachmentId:a[39],replyAttachmentExtra:a[40],isForwarded:a[41],forwardScore:a[42],hasQuickReplies:a[43],adminMsgCtaId:a[44],adminMsgCtaTitle:a[45],adminMsgCtaType:a[46],cannotUnsendReason:a[47],textHasLinks:a[48],viewFlags:a[49],displayedContentTypes:a[50],viewedPluginKey:a[51],viewedPluginContext:a[52],quickReplyType:a[53],hotEmojiSize:a[54],replySourceTimestampMs:a[55],ephemeralDurationInSec:a[56],msUntilExpirationTs:a[57],ephemeralExpirationTs:a[58],takedownState:a[59],isCollapsed:a[60]}):(d=c.item,b.i64.le(d.authorityLevel,a[2])?b.db.table(12).put({threadKey:a[3],timestampMs:a[5],messageId:a[8],offlineThreadingId:a[9],authorityLevel:a[2],primarySortKey:d.primarySortKey,senderId:a[10],isAdminMessage:a[12],sendStatus:a[14],sendStatusV2:a[15],text:a[0],subscriptErrorMessage:a[1],secondarySortKey:d.secondarySortKey,stickerId:a[11],isUnsent:a[16],unsentTimestampMs:a[17],mentionOffsets:a[18],mentionLengths:a[19],mentionIds:a[20],mentionTypes:a[21],replySourceId:a[22],replySourceType:a[23],replySourceTypeV2:a[24],replyStatus:a[25],replySnippet:a[26],replyMessageText:a[27],replyToUserId:a[28],replyMediaExpirationTimestampMs:a[29],replyMediaUrl:a[30],replyMediaPreviewWidth:a[32],replyMediaPreviewHeight:a[33],replyMediaUrlMimeType:a[34],replyMediaUrlFallback:a[35],replyCtaId:a[36],replyCtaTitle:a[37],replyAttachmentType:a[38],replyAttachmentId:a[39],replyAttachmentExtra:a[40],isForwarded:a[41],forwardScore:a[42],hasQuickReplies:a[43],adminMsgCtaId:a[44],adminMsgCtaTitle:a[45],adminMsgCtaType:a[46],cannotUnsendReason:a[47],textHasLinks:a[48],viewFlags:a[49],displayedContentTypes:a[50],viewedPluginKey:a[51],viewedPluginContext:a[52],quickReplyType:a[53],hotEmojiSize:a[54],replySourceTimestampMs:a[55],ephemeralDurationInSec:a[56],msUntilExpirationTs:a[57],ephemeralExpirationTs:a[58],takedownState:a[59],isCollapsed:a[60]}):b.resolve())})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSWriteThreadCapabilities",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({capabilities:a[1],capabilities2:a[2],capabilities3:a[3]})})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);